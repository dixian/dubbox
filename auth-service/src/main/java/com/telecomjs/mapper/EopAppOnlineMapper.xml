<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.telecomjs.mapper.EopAppOnlineMapper" >
  <resultMap id="BaseResultMap" type="com.telecomjs.entities.EopAppOnline" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    <result column="ONLINE_ID" property="onlineId" jdbcType="DECIMAL" />
    <result column="APP_ID" property="appId" jdbcType="DECIMAL" />
    <result column="APIKEY" property="apikey" jdbcType="VARCHAR" />
    <result column="APP_SECRET" property="appSecret" jdbcType="VARCHAR" />
    <result column="TOKEN" property="token" jdbcType="VARCHAR" />
    <result column="STATUS" property="status" jdbcType="VARCHAR" />
    <result column="TOKEN_STAMP" property="tokenStamp" jdbcType="VARCHAR" />
    <result column="CLIENT_IP" property="clientIp" jdbcType="VARCHAR" />
    <result column="CREATE_DATE" property="createDate" jdbcType="TIMESTAMP" />
  </resultMap>
  <insert id="insert" parameterType="com.telecomjs.entities.EopAppOnline" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    insert into EOP_APP_ONLINE (ONLINE_ID, APP_ID, APIKEY, 
      APP_SECRET, TOKEN, STATUS, 
      TOKEN_STAMP, CLIENT_IP, CREATE_DATE
      )
    values (#{onlineId,jdbcType=DECIMAL}, #{appId,jdbcType=DECIMAL}, #{apikey,jdbcType=VARCHAR}, 
      #{appSecret,jdbcType=VARCHAR}, #{token,jdbcType=VARCHAR}, #{status,jdbcType=VARCHAR}, 
      #{tokenStamp,jdbcType=VARCHAR}, #{clientIp,jdbcType=VARCHAR}, #{createDate,jdbcType=TIMESTAMP}
      )
  </insert>
  <insert id="insertSelective" parameterType="com.telecomjs.entities.EopAppOnline" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    insert into EOP_APP_ONLINE
    <trim prefix="(" suffix=")" suffixOverrides="," >
      <if test="onlineId != null" >
        ONLINE_ID,
      </if>
      <if test="appId != null" >
        APP_ID,
      </if>
      <if test="apikey != null" >
        APIKEY,
      </if>
      <if test="appSecret != null" >
        APP_SECRET,
      </if>
      <if test="token != null" >
        TOKEN,
      </if>
      <if test="status != null" >
        STATUS,
      </if>
      <if test="tokenStamp != null" >
        TOKEN_STAMP,
      </if>
      <if test="clientIp != null" >
        CLIENT_IP,
      </if>
      <if test="createDate != null" >
        CREATE_DATE,
      </if>
    </trim>
    <trim prefix="values (" suffix=")" suffixOverrides="," >
      <if test="onlineId != null" >
        #{onlineId,jdbcType=DECIMAL},
      </if>
      <if test="appId != null" >
        #{appId,jdbcType=DECIMAL},
      </if>
      <if test="apikey != null" >
        #{apikey,jdbcType=VARCHAR},
      </if>
      <if test="appSecret != null" >
        #{appSecret,jdbcType=VARCHAR},
      </if>
      <if test="token != null" >
        #{token,jdbcType=VARCHAR},
      </if>
      <if test="status != null" >
        #{status,jdbcType=VARCHAR},
      </if>
      <if test="tokenStamp != null" >
        #{tokenStamp,jdbcType=VARCHAR},
      </if>
      <if test="clientIp != null" >
        #{clientIp,jdbcType=VARCHAR},
      </if>
      <if test="createDate != null" >
        #{createDate,jdbcType=TIMESTAMP},
      </if>
    </trim>
  </insert>
  <insert id="archiveOnlineToken" parameterType="String">
    insert into EOP_APP_ONLINE_LOG
      SELECT ONLINE_ID, APP_ID, APIKEY,
      APP_SECRET, TOKEN, STATUS,
      TOKEN_STAMP, CLIENT_IP, CREATE_DATE
      WHERE token = #{token}
  </insert>
  <update id="updateAppOnLineByToken" parameterType="com.telecomjs.entities.EopAppOnline" >
    UPDATE EOP_APP_ONLINE
    <set>
      <if test="status != null" >
        STATUS = #{status,jdbcType=VARCHAR}
      </if>
    </set>
    WHERE ONLINE_ID = #{onlineId,jdbcType=DECIMAL}
  </update>
  <update id="updateArchiveAppOnLineByToken" parameterType="String">
  UPDATE EOP_APP_ONLINE
  set STATUS = 'END'
    WHERE token = #{token}
  </update>
  <delete id="deleteOnlineToken" parameterType="String">
    DELETE FROM EOP_APP_ONLINE
    WHERE token = #{token}
  </delete>
  <sql id="Base_Column_List" >
    ONLINE_ID, APP_ID, APIKEY,
      APP_SECRET, TOKEN, STATUS,
      TOKEN_STAMP, CLIENT_IP, CREATE_DATE
  </sql>
    <select id="getAppOnLineByToken" parameterType="String" resultMap="BaseResultMap">
      SELECT
      <include refid="Base_Column_List" />
      FROM EOP_APP_ONLINE
      WHERE token = #{token,jdbcType=VARCHAR}
    </select>
</mapper>